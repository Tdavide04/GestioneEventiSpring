<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Events - Homepage</title>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<style>
body {
	background: papayawhip;
	font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.navbar {
	background-color: maroon;
}

.navbar-brand, .nav-link {
	color: white !important;
	font-weight: 500;
}

h1 {
	font-weight: bold;
	color: maroon;
}

footer {
	margin-top: 40px;
	background-color: maroon;
	color: white;
	padding: 15px 0;
	text-align: center;
	position: fixed;
	bottom: 0;
	left: 0;
	width: 100%;
}
</style>
</head>
<body>

	<!-- Navbar -->
	<nav class="navbar navbar-expand-lg">
		<div class="container-fluid">
			<a class="navbar-brand" href="#">Event Management</a>
			<div class="collapse navbar-collapse">
				<ul class="navbar-nav ms-auto">
					

					<!-- ORGANIZZATORE o ADMIN possono creare eventi -->
					<li class="nav-item"
						th:if="${#strings.equals(loggedRuolo,'ORGANIZZATORE') or #strings.equals(loggedRuolo,'ADMIN')}">
						<a class="nav-link" th:href="@{/evento/nuovo}">Add Event</a>
					</li>

					<!-- ORGANIZZATORE o ADMIN possono creare categorie -->
					<li class="nav-item"
						th:if="${#strings.equals(loggedRuolo,'ORGANIZZATORE') or #strings.equals(loggedRuolo,'ADMIN')}">
						<a class="nav-link" th:href="@{/categoria/nuova}">Create
							Category</a>
					</li>

					<!-- Solo ADMIN può gestire utenti -->
					<li class="nav-item" th:if="${#strings.equals(loggedRuolo,'ADMIN')}">
						<a class="nav-link" th:href="@{/admin/lista-utenti}">Manage
							Users</a>
					</li>


					<!-- Logout sempre visibile -->
					<li class="nav-item"><a class="nav-link" th:href="@{/logout}">Logout</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container mt-4">

		<h1 class="mb-4">Event list</h1>

		<!-- Messaggi flash -->
		<div th:if="${success}" class="alert alert-success"
			th:text="${success}"></div>
		<div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
				
		<!-- Tabella eventi -->
		<table class="table table-bordered table-hover table-striped">
			<thead class="table-dark text-center">
				<tr>
					<th>Name</th>
					<th>Description</th>
					<th>Total places</th>
					<th>Category</th>
					<th>Price</th>
					<th>Start</th>
					<th>Finish</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="evento : ${eventi}">
					<td th:text="${evento.nome}">Name</td>
					<td th:text="${evento.descrizione}">Description</td>
					<td th:text="${evento.postiDisponibili}">0</td>
					<td th:text="${evento.categoria.nome}">Category</td>
					<td th:text="${evento.prezzo} + ' €'">0 €</td>
					<td th:text="${#temporals.format(evento.dataInizio, 'dd/MM/yyyy')}">01/01/2025</td>
					<td th:text="${#temporals.format(evento.dataFine, 'dd/MM/yyyy')}">02/01/2025</td>
					<td class="text-center"><a
						th:href="@{/prenotazione/nuova(eventoId=${evento.idEvento})}"
						class="btn btn-sm btn-success">Prenota</a></td>
				</tr>
			</tbody>
		</table>
	</div>

	<footer>
		<p>&copy; 2025 - Event Management</p>
	</footer>

</body>
</html>
